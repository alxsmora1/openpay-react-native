{"version":3,"sources":["index.js"],"names":["API_URL_SANDBOX","API_URL_PRODUCTION","vsprintf","sprintfJs","sessionId","toUpperCase","replace","createTokenWithCard","data","method","resource","sendFunction","username","publicKey","url","isProductionMode","merchantId","authorization","Buffer","toString","fetch","mode","cache","headers","body","JSON","stringify","then","response","json","catch","error","Openpay","Component","constructor","props","holder","expiration","cvv","number","hasOwnProperty","isBoolean","isString","isFunction","successToken","failToken","custom","deviceSession","isObject","address","labels","placeholders","identifierForVendor","uri","injectedJavaScript","setState","deviceSerial","window","Expo","Constants","appOwnership","console","log","installationId","deviceId","DeviceInfo","getUniqueId","e","form","cardForm","loading","card","expirationDate","split","requestData","card_number","holder_name","cvv2","expiration_month","expiration_year","error_code","creditCardRef","React","createRef","validateProps","Error","state","undefined","componentDidMount","createDeviceSessionId","render","handleSubmit","current","submit","tokenize","background","placeholderTextColor","CardWrapper","styles","cardWrapper","button","buttonText","StyleSheet","create","height","alignItems","backgroundColor","borderColor","borderWidth","borderRadius","marginBottom","justifyContent","marginTop","padding","width"],"mappings":"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","sourcesContent":["import React, {Component} from 'react';\nimport * as Expo from 'react-native';\nimport {StyleSheet, View} from 'react-native';\nimport uuidv4 from 'uuid/v4';\nimport DeviceInfo from 'react-native-device-info';\nimport sprintfJs from 'sprintf-js';\nimport {Buffer} from 'buffer';\nimport WebView from 'react-native-webview';\nimport CreditCard from 'react-native-credit-card-form-ui';\nimport {Button} from 'react-native-elements';\n\nconst API_URL_SANDBOX = 'https://sandbox-api.openpay.mx';\nconst API_URL_PRODUCTION = 'https://api.openpay.mx';\n\nconst vsprintf = sprintfJs.vsprintf;\nlet sessionId = uuidv4();\nsessionId = sessionId.toUpperCase().replace(/-/g, '');\n\nexport const createTokenWithCard = async (data) => {\n    const method = 'POST';\n    const resource = 'tokens';\n    return await sendFunction(method, resource, data);\n};\n\nconst sendFunction = (method, resource, data) => {\n    const username = data.publicKey;\n    const url = vsprintf('%s/v1/%s/%s', [\n        data.isProductionMode ? API_URL_PRODUCTION : API_URL_SANDBOX,\n        data.merchantId,\n        resource,\n    ]);\n    const authorization =\n        'Basic ' + new Buffer(username + ':').toString('base64');\n\n    return fetch(url, {\n        method: method,\n        mode: 'no-cors',\n        cache: 'no-cache',\n        headers: {\n            'Content-Type': 'application/json',\n            'Authorization': authorization,\n        },\n        body: JSON.stringify(data),\n    })\n        .then((response) => response.json()) // parses response to JSON\n        .catch((error) => {\n            throw error;\n        });\n};\n\nexport class Openpay extends Component {\n    creditCardRef;\n\n    labels = {\n        holder: 'Full Name',\n        expiration: 'Expiration Date',\n        cvv: 'Security Code',\n    };\n\n    placeholders = {\n        holder: \"Holder's Name\",\n        number: '**** **** **** ****',\n        expiration: 'MM/YY',\n        cvv: 'CVV',\n    };\n\n    constructor(props) {\n        super(props);\n\n        this.creditCardRef = React.createRef();\n\n        if (!this.validateProps(props)) {\n            throw new Error('Openpay component requires all the specified props.');\n        }\n        this.state = {\n            sessionId: undefined,\n            uri: '',\n            injectedJavaScript: '',\n            loading: false,\n        };\n    }\n\n    componentDidMount() {\n        this.createDeviceSessionId();\n    }\n\n    validateProps = (props) => {\n        // Se valida que existan las propiedad requeridas\n        if (\n            !props.hasOwnProperty('isProductionMode') ||\n            !props.hasOwnProperty('merchantId') ||\n            !props.hasOwnProperty('publicKey') ||\n            !props.hasOwnProperty('successToken') ||\n            !props.hasOwnProperty('failToken') ||\n            !props.hasOwnProperty('custom')\n        ) {\n            return false;\n        }\n\n        // Se validan los tipos de dato\n        if (!isBoolean(props.isProductionMode)) {\n            return false;\n        }\n\n        if (!isString(props.merchantId)) {\n            return false;\n        }\n\n        if (!isString(props.publicKey)) {\n            return false;\n        }\n\n        if (!isFunction(props.successToken)) {\n            return false;\n        }\n\n        if (!isFunction(props.failToken)) {\n            return false;\n        }\n\n        if (!isBoolean(props.custom)) {\n            return false;\n        }\n\n        if (!isBoolean(props.custom)) {\n            return false;\n        } else if (props.custom && !isFunction(props.deviceSession)) {\n            return false;\n        }\n\n        if (props.hasOwnProperty('address') && !isObject(props.address)) {\n            return false;\n        }\n\n        if (props.hasOwnProperty('labels')) {\n            if (!isObject(props.labels)) {\n                return false;\n            } else {\n                this.labels.cvv = props.labels.cvv || this.labels.cvv;\n                this.labels.holder = props.labels.holder || this.labels.holder;\n                this.labels.expiration = props.labels.expiration || this.labels.expiration;\n            }\n        }\n\n        if (props.hasOwnProperty('placeholders')) {\n            if (!isObject(props.labels)) {\n                return false;\n            } else {\n                this.placeholders.holder = props.placeholders.holder || this.placeholders.holder;\n                this.placeholders.number = props.placeholders.number || this.placeholders.number;\n                this.placeholders.expiration = props.placeholders.expiration || this.placeholders.expiration;\n                this.placeholders.cvv = props.placeholders.cvv || this.placeholders.cvv;\n            }\n        }\n\n        return true;\n    };\n\n    createDeviceSessionId = () => {\n        let identifierForVendor = this.identifierForVendor();\n        identifierForVendor = identifierForVendor.replace(/-/g, '');\n\n        const uri = vsprintf('%s/oa/logo.htm?m=%s&s=%s', [\n            this.props.isProductionMode ? API_URL_PRODUCTION : API_URL_SANDBOX,\n            this.props.merchantId,\n            sessionId,\n        ]);\n        const injectedJavaScript = vsprintf('var identifierForVendor = \"%s\";', [\n            identifierForVendor,\n        ]);\n\n        this.setState(() => ({uri, injectedJavaScript}));\n        this.props.deviceSession(sessionId);\n    };\n\n    identifierForVendor = () => {\n        let deviceSerial = '';\n        try {\n            if (window.Expo && window.Expo.Constants.appOwnership === 'expo') {\n                console.log('Running in expo');\n                deviceSerial =\n                    typeof Expo.Constants.installationId !== 'undefined'\n                        ? Expo.Constants.installationId\n                        : Expo.Constants.deviceId;\n            } else {\n                deviceSerial = DeviceInfo.getUniqueId();\n            }\n        } catch (e) {\n            console.log('error reading device ID', e);\n        }\n\n        return deviceSerial;\n    };\n\n    tokenize = async (form) => {\n        console.log('******** tokenize ******');\n        const cardForm = form;\n\n        this.setState(() => ({loading: true}));\n\n        const card = cardForm;\n        const expirationDate = card.expiration.split('/');\n        const requestData = {\n            card_number: card.number.replace(/ /g, ''),\n            holder_name: card.holder,\n            cvv2: card.cvv,\n            expiration_month: expirationDate[0],\n            expiration_year: expirationDate[1],\n            isProductionMode: this.props.isProductionMode,\n            merchantId: this.props.merchantId,\n            publicKey: this.props.publicKey,\n        };\n\n        if (this.props.address) {\n            requestData.address = this.props.address;\n        }\n\n        try {\n            const response = await createTokenWithCard(requestData);\n            if (response.error_code) {\n                this.props.failToken(response);\n            } else {\n                this.props.successToken(response);\n            }\n        } catch (error) {\n            this.props.failToken(error);\n        }\n    };\n\n    render() {\n\n        const {uri, injectedJavaScript, loading} = this.state;\n\n        const handleSubmit = async () => {\n            if (this.creditCardRef.current) {\n                const {error, data} = this.creditCardRef.current.submit();\n                console.log('ERROR: ', error);\n                console.log('CARD DATA: ', data);\n                await this.tokenize(data);\n            }\n        };\n\n        const background = '#ff7600';\n        const placeholderTextColor = '#ffffff';\n\n        const CardWrapper = () => {\n            if (!this.props.custom) {\n                return (\n                    <View style={styles.cardWrapper}>\n                        <CreditCard\n                            ref={this.creditCardRef}\n                            labels={this.labels}\n                            placeholders={this.placeholders}\n                            background={background}\n                            placeholderTextColor={placeholderTextColor}\n                        />\n                        <Button\n                            buttonStyle={styles.button}\n                            title={this.props.buttonText}\n                            onPress={handleSubmit}\n                        />\n                    </View>\n                );\n            } else {\n                return <View/>;\n            }\n        };\n\n        return (\n            <View>\n                <CardWrapper/>\n                <WebView\n                    source={{uri: uri}}\n                    injectedJavaScript={injectedJavaScript}\n                />\n            </View>\n        );\n    }\n}\n\nconst styles = StyleSheet.create({\n    cardWrapper: {\n        height: 300,\n        alignItems: 'center',\n    },\n    button: {\n        height: 45,\n        backgroundColor: '#ff7600',\n        borderColor: '#ff7600',\n        borderWidth: 1,\n        borderRadius: 8,\n        marginBottom: 5,\n        justifyContent: 'center',\n        marginTop: 30,\n        padding: 5,\n        width: 340,\n    },\n});\n\n"]}