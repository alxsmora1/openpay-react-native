{"version":3,"sources":["index.js"],"names":["React","Component","Expo","KeyboardAvoidingView","Platform","StyleSheet","View","uuidv4","DeviceInfo","sprintfJs","Buffer","WebView","CreditCard","Button","API_URL_SANDBOX","API_URL_PRODUCTION","vsprintf","sessionId","toUpperCase","replace","createTokenWithCard","data","method","resource","sendFunction","username","publicKey","url","isProductionMode","merchantId","authorization","toString","fetch","mode","cache","headers","body","JSON","stringify","then","response","json","catch","error","Openpay","constructor","props","holder","expiration","cvv","number","hasOwnProperty","isBoolean","isString","isFunction","successToken","failToken","custom","deviceSession","isObject","address","labels","placeholders","identifierForVendor","uri","injectedJavaScript","setState","deviceSerial","window","Constants","appOwnership","console","log","installationId","deviceId","getUniqueId","e","form","cardForm","loading","card","expirationDate","split","requestData","card_number","holder_name","cvv2","expiration_month","expiration_year","error_code","creditCardRef","createRef","validateProps","Error","state","undefined","componentDidMount","createDeviceSessionId","render","handleSubmit","current","submit","tokenize","background","placeholderTextColor","CardWrapper","OS","styles","button","buttonText","container","create","paddingBottom","height","backgroundColor","borderColor","borderWidth","borderRadius","marginBottom","justifyContent","marginTop","padding","width","value","Object","String","isNumber","isFinite","isNull","isUndefined"],"mappings":"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","sourcesContent":["import React, {Component} from 'react';\nimport * as Expo from 'react-native';\nimport {KeyboardAvoidingView, Platform, StyleSheet, View} from 'react-native';\nimport uuidv4 from 'uuid/v4';\nimport DeviceInfo from 'react-native-device-info';\nimport sprintfJs from 'sprintf-js';\nimport {Buffer} from 'buffer';\nimport WebView from 'react-native-webview';\nimport CreditCard from 'react-native-credit-card-form-ui';\nimport {Button} from 'react-native-elements';\n\nconst API_URL_SANDBOX = 'https://sandbox-api.openpay.mx';\nconst API_URL_PRODUCTION = 'https://api.openpay.mx';\n\nconst vsprintf = sprintfJs.vsprintf;\nlet sessionId = uuidv4();\nsessionId = sessionId.toUpperCase().replace(/-/g, '');\n\nexport const createTokenWithCard = async (data) => {\n    const method = 'POST';\n    const resource = 'tokens';\n    return await sendFunction(method, resource, data);\n};\n\nconst sendFunction = (method, resource, data) => {\n    const username = data.publicKey;\n    const url = vsprintf('%s/v1/%s/%s', [\n        data.isProductionMode ? API_URL_PRODUCTION : API_URL_SANDBOX,\n        data.merchantId,\n        resource,\n    ]);\n    const authorization =\n        'Basic ' + new Buffer(username + ':').toString('base64');\n\n    return fetch(url, {\n        method: method,\n        mode: 'no-cors',\n        cache: 'no-cache',\n        headers: {\n            'Content-Type': 'application/json',\n            'Authorization': authorization,\n        },\n        body: JSON.stringify(data),\n    })\n        .then((response) => response.json()) // parses response to JSON\n        .catch((error) => {\n            throw error;\n        });\n};\n\nexport class Openpay extends Component {\n    creditCardRef;\n\n    labels = {\n        holder: 'Full Name',\n        expiration: 'Expiration Date',\n        cvv: 'Security Code',\n    };\n\n    placeholders = {\n        holder: \"Holder's Name\",\n        number: '**** **** **** ****',\n        expiration: 'MM/YY',\n        cvv: 'CVV',\n    };\n\n    constructor(props) {\n        super(props);\n\n        this.creditCardRef = React.createRef();\n\n        if (!this.validateProps(props)) {\n            throw new Error('Openpay component requires all the specified props.');\n        }\n        this.state = {\n            sessionId: undefined,\n            uri: '',\n            injectedJavaScript: '',\n            loading: false,\n        };\n    }\n\n    componentDidMount() {\n        this.createDeviceSessionId();\n    }\n\n    validateProps = (props) => {\n        // Se valida que existan las propiedad requeridas\n        if (\n            !props.hasOwnProperty('isProductionMode') ||\n            !props.hasOwnProperty('merchantId') ||\n            !props.hasOwnProperty('publicKey') ||\n            !props.hasOwnProperty('successToken') ||\n            !props.hasOwnProperty('failToken') ||\n            !props.hasOwnProperty('custom')\n        ) {\n            return false;\n        }\n\n        // Se validan los tipos de dato\n        if (!isBoolean(props.isProductionMode)) {\n            return false;\n        }\n\n        if (!isString(props.merchantId)) {\n            return false;\n        }\n\n        if (!isString(props.publicKey)) {\n            return false;\n        }\n\n        if (!isFunction(props.successToken)) {\n            return false;\n        }\n\n        if (!isFunction(props.failToken)) {\n            return false;\n        }\n\n        if (!isBoolean(props.custom)) {\n            return false;\n        }\n\n        if (!isBoolean(props.custom)) {\n            return false;\n        } else if (props.custom && !isFunction(props.deviceSession)) {\n            return false;\n        }\n\n        if (props.hasOwnProperty('address') && !isObject(props.address)) {\n            return false;\n        }\n\n        if (props.hasOwnProperty('labels')) {\n            if (!isObject(props.labels)) {\n                return false;\n            } else {\n                this.labels.cvv = props.labels.cvv || this.labels.cvv;\n                this.labels.holder = props.labels.holder || this.labels.holder;\n                this.labels.expiration = props.labels.expiration || this.labels.expiration;\n            }\n        }\n\n        if (props.hasOwnProperty('placeholders')) {\n            if (!isObject(props.labels)) {\n                return false;\n            } else {\n                this.placeholders.holder = props.placeholders.holder || this.placeholders.holder;\n                this.placeholders.number = props.placeholders.number || this.placeholders.number;\n                this.placeholders.expiration = props.placeholders.expiration || this.placeholders.expiration;\n                this.placeholders.cvv = props.placeholders.cvv || this.placeholders.cvv;\n            }\n        }\n\n        return true;\n    };\n\n    createDeviceSessionId = () => {\n        let identifierForVendor = this.identifierForVendor();\n        identifierForVendor = identifierForVendor.replace(/-/g, '');\n\n        const uri = vsprintf('%s/oa/logo.htm?m=%s&s=%s', [\n            this.props.isProductionMode ? API_URL_PRODUCTION : API_URL_SANDBOX,\n            this.props.merchantId,\n            sessionId,\n        ]);\n        const injectedJavaScript = vsprintf('var identifierForVendor = \"%s\";', [\n            identifierForVendor,\n        ]);\n\n        this.setState(() => ({uri, injectedJavaScript}));\n        this.props.deviceSession(sessionId);\n    };\n\n    identifierForVendor = () => {\n        let deviceSerial = '';\n        try {\n            if (window.Expo && window.Expo.Constants.appOwnership === 'expo') {\n                console.log('Running in expo');\n                deviceSerial =\n                    typeof Expo.Constants.installationId !== 'undefined'\n                        ? Expo.Constants.installationId\n                        : Expo.Constants.deviceId;\n            } else {\n                deviceSerial = DeviceInfo.getUniqueId();\n            }\n        } catch (e) {\n            console.log('error reading device ID', e);\n        }\n\n        return deviceSerial;\n    };\n\n    tokenize = async (form) => {\n        console.log('******** tokenize ******');\n        const cardForm = form;\n\n        this.setState(() => ({loading: true}));\n\n        const card = cardForm;\n        const expirationDate = card.expiration.split('/');\n        const requestData = {\n            card_number: card.number.replace(/ /g, ''),\n            holder_name: card.holder,\n            cvv2: card.cvv,\n            expiration_month: expirationDate[0],\n            expiration_year: expirationDate[1],\n            isProductionMode: this.props.isProductionMode,\n            merchantId: this.props.merchantId,\n            publicKey: this.props.publicKey,\n        };\n\n        if (this.props.address) {\n            requestData.address = this.props.address;\n        }\n\n        try {\n            const response = await createTokenWithCard(requestData);\n            if (response.error_code) {\n                this.props.failToken(response);\n            } else {\n                this.props.successToken(response);\n            }\n        } catch (error) {\n            this.props.failToken(error);\n        }\n    };\n\n    render() {\n\n        const {uri, injectedJavaScript, loading} = this.state;\n\n        const handleSubmit = async () => {\n            if (this.creditCardRef.current) {\n                const {error, data} = this.creditCardRef.current.submit();\n                console.log('ERROR: ', error);\n                console.log('CARD DATA: ', data);\n                await this.tokenize(data);\n            }\n        };\n\n        const background = '#ff7600';\n        const placeholderTextColor = '#ffffff';\n\n        const CardWrapper = () => {\n            if (!this.props.custom) {\n                return (\n                    <KeyboardAvoidingView\n                        behavior={Platform.OS === 'ios' ? 'padding' : 'height'}\n                        keyboardVerticalOffset={20}\n                    >\n                        <CreditCard\n                            ref={this.creditCardRef}\n                            labels={this.labels}\n                            placeholders={this.placeholders}\n                            background={background}\n                            placeholderTextColor={placeholderTextColor}\n                        />\n                        <Button\n                            buttonStyle={styles.button}\n                            title={this.props.buttonText}\n                            onPress={handleSubmit}\n                        />\n                    </KeyboardAvoidingView>\n                );\n            } else {\n                return <View/>;\n            }\n        };\n\n        return (\n            <View style={styles.container}>\n                <CardWrapper/>\n                <WebView\n                    source={{uri: uri}}\n                    injectedJavaScript={injectedJavaScript}\n                />\n            </View>\n        );\n    }\n}\n\nconst styles = StyleSheet.create({\n    container: {\n        paddingBottom: 400,\n    },\n    button: {\n        height: 45,\n        backgroundColor: '#ff7600',\n        borderColor: '#ff7600',\n        borderWidth: 1,\n        borderRadius: 8,\n        marginBottom: 5,\n        justifyContent: 'center',\n        marginTop: 30,\n        padding: 5,\n        width: '100%',\n    },\n});\n\nconst isFunction = (value) => {\n    return typeof value === 'function';\n};\n\nconst isObject = (value) => {\n    return value && typeof value === 'object' && value.constructor === Object;\n};\n\nconst isString = (value) => {\n    return typeof value === 'string' || value instanceof String;\n};\n\nconst isBoolean = (value) => {\n    return typeof value === 'boolean';\n};\n\nconst isNumber = (value) => {\n    return typeof value === 'number' && isFinite(value);\n};\n\nconst isNull = (value) => {\n    return value === null;\n};\n\n// Returns if a value is undefined\nconst isUndefined = (value) => {\n    return typeof value === 'undefined';\n};\n"]}